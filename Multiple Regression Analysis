{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\ProgramData\\Anaconda3\\lib\\site-packages\\numpy\\core\\fromnumeric.py:2389: FutureWarning: Method .ptp is deprecated and will be removed in a future version. Use numpy.ptp instead.\n",
      "  return ptp(axis=axis, out=out, **kwargs)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>OLS Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>          <td>sales</td>      <th>  R-squared:         </th> <td>   0.066</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.064</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   33.93</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>             <td>Mon, 02 Dec 2019</td> <th>  Prob (F-statistic):</th> <td>3.42e-21</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                 <td>04:42:30</td>     <th>  Log-Likelihood:    </th> <td> -8546.2</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>No. Observations:</th>      <td>  1451</td>      <th>  AIC:               </th> <td>1.710e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Residuals:</th>          <td>  1447</td>      <th>  BIC:               </th> <td>1.712e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>const</th>     <td>   73.3654</td> <td>    4.676</td> <td>   15.689</td> <td> 0.000</td> <td>   64.192</td> <td>   82.538</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable1</th> <td>   21.8175</td> <td>    4.766</td> <td>    4.578</td> <td> 0.000</td> <td>   12.468</td> <td>   31.167</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable2</th> <td>    0.1644</td> <td>    0.017</td> <td>    9.802</td> <td> 0.000</td> <td>    0.131</td> <td>    0.197</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable3</th> <td>    7.2755</td> <td>   11.658</td> <td>    0.624</td> <td> 0.533</td> <td>  -15.593</td> <td>   30.144</td>\n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "  <th>Omnibus:</th>       <td>1312.005</td> <th>  Durbin-Watson:     </th> <td>   2.010</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Prob(Omnibus):</th>  <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>73984.329</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Skew:</th>           <td> 3.992</td>  <th>  Prob(JB):          </th> <td>    0.00</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Kurtosis:</th>       <td>37.059</td>  <th>  Cond. No.          </th> <td>1.12e+03</td> \n",
       "</tr>\n",
       "</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.12e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems."
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                            OLS Regression Results                            \n",
       "==============================================================================\n",
       "Dep. Variable:                  sales   R-squared:                       0.066\n",
       "Model:                            OLS   Adj. R-squared:                  0.064\n",
       "Method:                 Least Squares   F-statistic:                     33.93\n",
       "Date:                Mon, 02 Dec 2019   Prob (F-statistic):           3.42e-21\n",
       "Time:                        04:42:30   Log-Likelihood:                -8546.2\n",
       "No. Observations:                1451   AIC:                         1.710e+04\n",
       "Df Residuals:                    1447   BIC:                         1.712e+04\n",
       "Df Model:                           3                                         \n",
       "Covariance Type:            nonrobust                                         \n",
       "==============================================================================\n",
       "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
       "------------------------------------------------------------------------------\n",
       "const         73.3654      4.676     15.689      0.000      64.192      82.538\n",
       "variable1     21.8175      4.766      4.578      0.000      12.468      31.167\n",
       "variable2      0.1644      0.017      9.802      0.000       0.131       0.197\n",
       "variable3      7.2755     11.658      0.624      0.533     -15.593      30.144\n",
       "==============================================================================\n",
       "Omnibus:                     1312.005   Durbin-Watson:                   2.010\n",
       "Prob(Omnibus):                  0.000   Jarque-Bera (JB):            73984.329\n",
       "Skew:                           3.992   Prob(JB):                         0.00\n",
       "Kurtosis:                      37.059   Cond. No.                     1.12e+03\n",
       "==============================================================================\n",
       "\n",
       "Warnings:\n",
       "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n",
       "[2] The condition number is large, 1.12e+03. This might indicate that there are\n",
       "strong multicollinearity or other numerical problems.\n",
       "\"\"\""
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import statsmodels.api as sm\n",
    "\n",
    "#download the datasets from https://gofile.io/?c=ExNpOy\n",
    "multiregtrain = pd.read_csv(\"C:\\MyDataSets\\Datasets\\multiple_regression_train.csv\")\n",
    "multiregtest = pd.read_csv(\"C:\\MyDataSets\\Datasets\\multiple_regression_test.csv\")\n",
    "\n",
    "#identify predictor and target variables\n",
    "X = pd.DataFrame(multiregtrain[['variable1', 'variable2', 'variable3']])\n",
    "Y = pd.DataFrame(multiregtrain[['sales']])\n",
    "\n",
    "#add the constant b0 (intercept) to our predictors (1.0 in this instance)\n",
    "X = sm.add_constant(X)\n",
    "\n",
    "#use the ordinary least square method to fit the model\n",
    "regmodel = sm.OLS(Y, X).fit()\n",
    "\n",
    "#view the output of the current regmodel. The estimation will be performed once there are desirable results\n",
    "regmodel.summary()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>OLS Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>          <td>sales</td>      <th>  R-squared:         </th> <td>   0.063</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.061</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   31.36</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>             <td>Mon, 02 Dec 2019</td> <th>  Prob (F-statistic):</th> <td>1.30e-19</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                 <td>04:42:30</td>     <th>  Log-Likelihood:    </th> <td> -8003.6</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>No. Observations:</th>      <td>  1395</td>      <th>  AIC:               </th> <td>1.602e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Residuals:</th>          <td>  1391</td>      <th>  BIC:               </th> <td>1.604e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>const</th>     <td>   80.2877</td> <td>    4.000</td> <td>   20.071</td> <td> 0.000</td> <td>   72.441</td> <td>   88.135</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable1</th> <td>   20.8955</td> <td>    4.170</td> <td>    5.011</td> <td> 0.000</td> <td>   12.716</td> <td>   29.075</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable2</th> <td>    0.1261</td> <td>    0.014</td> <td>    9.120</td> <td> 0.000</td> <td>    0.099</td> <td>    0.153</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable3</th> <td>   12.4811</td> <td>    9.054</td> <td>    1.378</td> <td> 0.168</td> <td>   -5.280</td> <td>   30.242</td>\n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "  <th>Omnibus:</th>       <td>555.436</td> <th>  Durbin-Watson:     </th> <td>   1.930</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>2318.947</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Skew:</th>          <td> 1.897</td>  <th>  Prob(JB):          </th> <td>    0.00</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Kurtosis:</th>      <td> 8.049</td>  <th>  Cond. No.          </th> <td>1.02e+03</td>\n",
       "</tr>\n",
       "</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.02e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems."
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                            OLS Regression Results                            \n",
       "==============================================================================\n",
       "Dep. Variable:                  sales   R-squared:                       0.063\n",
       "Model:                            OLS   Adj. R-squared:                  0.061\n",
       "Method:                 Least Squares   F-statistic:                     31.36\n",
       "Date:                Mon, 02 Dec 2019   Prob (F-statistic):           1.30e-19\n",
       "Time:                        04:42:30   Log-Likelihood:                -8003.6\n",
       "No. Observations:                1395   AIC:                         1.602e+04\n",
       "Df Residuals:                    1391   BIC:                         1.604e+04\n",
       "Df Model:                           3                                         \n",
       "Covariance Type:            nonrobust                                         \n",
       "==============================================================================\n",
       "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
       "------------------------------------------------------------------------------\n",
       "const         80.2877      4.000     20.071      0.000      72.441      88.135\n",
       "variable1     20.8955      4.170      5.011      0.000      12.716      29.075\n",
       "variable2      0.1261      0.014      9.120      0.000       0.099       0.153\n",
       "variable3     12.4811      9.054      1.378      0.168      -5.280      30.242\n",
       "==============================================================================\n",
       "Omnibus:                      555.436   Durbin-Watson:                   1.930\n",
       "Prob(Omnibus):                  0.000   Jarque-Bera (JB):             2318.947\n",
       "Skew:                           1.897   Prob(JB):                         0.00\n",
       "Kurtosis:                       8.049   Cond. No.                     1.02e+03\n",
       "==============================================================================\n",
       "\n",
       "Warnings:\n",
       "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n",
       "[2] The condition number is large, 1.02e+03. This might indicate that there are\n",
       "strong multicollinearity or other numerical problems.\n",
       "\"\"\""
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#running the test model to test more results. If a test model is not available, split the dataset using:\n",
    "#X_train, X_test, Y_train, Y_test = model_selection.train_test_split(X, Y, test_size = 0.4, random_state=25)\n",
    "#NEVER use train data to test the same data used to train\n",
    "X_test = pd.DataFrame(multiregtest[['variable1', 'variable2', 'variable3']])\n",
    "Y_test = pd.DataFrame(multiregtest[['sales']])\n",
    "X_test = sm.add_constant(X_test)\n",
    "regtestmodel = sm.OLS(Y_test, X_test).fit()\n",
    "regtestmodel.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>OLS Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>          <td>sales</td>      <th>  R-squared:         </th> <td>   0.065</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.064</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   50.72</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>             <td>Mon, 02 Dec 2019</td> <th>  Prob (F-statistic):</th> <td>5.12e-22</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                 <td>04:42:30</td>     <th>  Log-Likelihood:    </th> <td> -8546.4</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>No. Observations:</th>      <td>  1451</td>      <th>  AIC:               </th> <td>1.710e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Residuals:</th>          <td>  1448</td>      <th>  BIC:               </th> <td>1.711e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>const</th>     <td>   73.6209</td> <td>    4.657</td> <td>   15.808</td> <td> 0.000</td> <td>   64.485</td> <td>   82.757</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable1</th> <td>   22.1357</td> <td>    4.738</td> <td>    4.672</td> <td> 0.000</td> <td>   12.842</td> <td>   31.429</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable2</th> <td>    0.1637</td> <td>    0.017</td> <td>    9.784</td> <td> 0.000</td> <td>    0.131</td> <td>    0.197</td>\n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "  <th>Omnibus:</th>       <td>1310.431</td> <th>  Durbin-Watson:     </th> <td>   2.008</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Prob(Omnibus):</th>  <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>73656.633</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Skew:</th>           <td> 3.985</td>  <th>  Prob(JB):          </th> <td>    0.00</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Kurtosis:</th>       <td>36.982</td>  <th>  Cond. No.          </th> <td>    578.</td> \n",
       "</tr>\n",
       "</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified."
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                            OLS Regression Results                            \n",
       "==============================================================================\n",
       "Dep. Variable:                  sales   R-squared:                       0.065\n",
       "Model:                            OLS   Adj. R-squared:                  0.064\n",
       "Method:                 Least Squares   F-statistic:                     50.72\n",
       "Date:                Mon, 02 Dec 2019   Prob (F-statistic):           5.12e-22\n",
       "Time:                        04:42:30   Log-Likelihood:                -8546.4\n",
       "No. Observations:                1451   AIC:                         1.710e+04\n",
       "Df Residuals:                    1448   BIC:                         1.711e+04\n",
       "Df Model:                           2                                         \n",
       "Covariance Type:            nonrobust                                         \n",
       "==============================================================================\n",
       "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
       "------------------------------------------------------------------------------\n",
       "const         73.6209      4.657     15.808      0.000      64.485      82.757\n",
       "variable1     22.1357      4.738      4.672      0.000      12.842      31.429\n",
       "variable2      0.1637      0.017      9.784      0.000       0.131       0.197\n",
       "==============================================================================\n",
       "Omnibus:                     1310.431   Durbin-Watson:                   2.008\n",
       "Prob(Omnibus):                  0.000   Jarque-Bera (JB):            73656.633\n",
       "Skew:                           3.985   Prob(JB):                         0.00\n",
       "Kurtosis:                      36.982   Cond. No.                         578.\n",
       "==============================================================================\n",
       "\n",
       "Warnings:\n",
       "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n",
       "\"\"\""
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#For multicollinearity issues/overfitting, conduct the test again with fewer variables\n",
    "X = pd.DataFrame(multiregtrain[['variable1', 'variable2']])\n",
    "X = sm.add_constant(X)\n",
    "regmodel2 = sm.OLS(Y, X).fit()\n",
    "regmodel2.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>OLS Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>          <td>sales</td>      <th>  R-squared:         </th> <td>   0.062</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.061</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   46.06</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>             <td>Mon, 02 Dec 2019</td> <th>  Prob (F-statistic):</th> <td>4.29e-20</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                 <td>04:42:30</td>     <th>  Log-Likelihood:    </th> <td> -8004.5</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>No. Observations:</th>      <td>  1395</td>      <th>  AIC:               </th> <td>1.602e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Residuals:</th>          <td>  1392</td>      <th>  BIC:               </th> <td>1.603e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>const</th>     <td>   80.7656</td> <td>    3.986</td> <td>   20.260</td> <td> 0.000</td> <td>   72.946</td> <td>   88.586</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable1</th> <td>   21.5262</td> <td>    4.146</td> <td>    5.192</td> <td> 0.000</td> <td>   13.393</td> <td>   29.659</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>variable2</th> <td>    0.1254</td> <td>    0.014</td> <td>    9.071</td> <td> 0.000</td> <td>    0.098</td> <td>    0.152</td>\n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "  <th>Omnibus:</th>       <td>554.457</td> <th>  Durbin-Watson:     </th> <td>   1.929</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>2308.535</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Skew:</th>          <td> 1.895</td>  <th>  Prob(JB):          </th> <td>    0.00</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Kurtosis:</th>      <td> 8.036</td>  <th>  Cond. No.          </th> <td>    588.</td>\n",
       "</tr>\n",
       "</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified."
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                            OLS Regression Results                            \n",
       "==============================================================================\n",
       "Dep. Variable:                  sales   R-squared:                       0.062\n",
       "Model:                            OLS   Adj. R-squared:                  0.061\n",
       "Method:                 Least Squares   F-statistic:                     46.06\n",
       "Date:                Mon, 02 Dec 2019   Prob (F-statistic):           4.29e-20\n",
       "Time:                        04:42:30   Log-Likelihood:                -8004.5\n",
       "No. Observations:                1395   AIC:                         1.602e+04\n",
       "Df Residuals:                    1392   BIC:                         1.603e+04\n",
       "Df Model:                           2                                         \n",
       "Covariance Type:            nonrobust                                         \n",
       "==============================================================================\n",
       "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
       "------------------------------------------------------------------------------\n",
       "const         80.7656      3.986     20.260      0.000      72.946      88.586\n",
       "variable1     21.5262      4.146      5.192      0.000      13.393      29.659\n",
       "variable2      0.1254      0.014      9.071      0.000       0.098       0.152\n",
       "==============================================================================\n",
       "Omnibus:                      554.457   Durbin-Watson:                   1.929\n",
       "Prob(Omnibus):                  0.000   Jarque-Bera (JB):             2308.535\n",
       "Skew:                           1.895   Prob(JB):                         0.00\n",
       "Kurtosis:                       8.036   Cond. No.                         588.\n",
       "==============================================================================\n",
       "\n",
       "Warnings:\n",
       "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n",
       "\"\"\""
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#also conduct the score in the test dataset\n",
    "X_test = pd.DataFrame(multiregtest[['variable1', 'variable2']])\n",
    "Y_test = pd.DataFrame(multiregtest[['sales']])\n",
    "X_test = sm.add_constant(X_test)\n",
    "regtestmodel2 = sm.OLS(Y_test, X_test).fit()\n",
    "regtestmodel2.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0    128.145538\n",
      "dtype: float64    sales\n",
      "0   64.5        sales\n",
      "0  63.645538\n"
     ]
    }
   ],
   "source": [
    "#apply the estimation formula to determine potential customer sales\n",
    "#estimating the potential error by applying the predicted value to the actual value\n",
    "observation1 = X[ :1]\n",
    "pred1 = regmodel2.predict(observation1)\n",
    "actual1 = Y_test[ :1]\n",
    "profloss1 = [pred1] - actual1\n",
    "print(pred1, actual1, profloss1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MAE: 53.38639553029399\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score\n",
    "\n",
    "#use the second reg model to obtain the predicted values of the observations in the dataset\n",
    "ypred = regmodel2.predict(X_test)\n",
    "\n",
    "#estimate square root of the model\n",
    "np.sqrt(regmodel2.scale)\n",
    "ytrue = multiregtest[['sales']]\n",
    "\n",
    "#determine the mean absolute error for the whole test dataset\n",
    "MAE = mean_absolute_error(y_true = ytrue, y_pred = ypred)\n",
    "print(\"MAE:\", MAE)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
